<?xml version="1.0" encoding="UTF-8"?>
<amigoConfiguration>
	<repositoryConfig>
		<dbConfig name="AMIGO_DB_RussianIsland" serverIP="127.0.0.1" tCPport="27017"/>
		<!-- Общая мнемоника для псевдоизмерений -->
		<!-- Сценарии -->
		<!-- AS** - автоматизированное управление -->
		<!-- BS** - базовый сценарий -->

		<!-- Функции -->
		<!-- MX** - максимальные значения за интервал -->
		<!-- MN** - минимальные значения за интервал -->
		<!-- AV** - средние значения за интервал -->
		<!-- DT** - приращение значения за интервал времени -->

		<!-- Специфичные для оборудования -->
		<!-- CH** - для накопителей - процессы относящиеся к заряду -->
		<!-- DC** - для накопителей - процессы относящиеся к разряду -->
		<!-- EF** - для накопителей - КПД накопителей -->
		<!-- WT** - для накопителей - время работы накопителей -->
		<!-- IP** - для регулярной сети - процессы, относящиеся к поступающей из сети мощности -->
		<!-- OP** - для регулярной сети - процессы, относящиеся к передаваемой в сеть мощности -->
		<!-- PS** - для СЭС - потенциальная выработка СЭС -->
		<!-- US** - для СЭС - неиспользованная энергия СЭС -->

		<!-- По временному разрешению -->
		<!-- **MM - телеметрия -->
		<!-- **1H - агрегация за час -->
		<!-- **1D - агрегация за день -->
		<!-- **1W - агрегация за неделю -->
		<!-- **MO - агрегация за месяц -->
		<!-- **1Y - агрегация за год -->
		<!-- **TT - агрегация за весь срок -->

		<!-- Экономические -->
		<!-- PF** - профит -->
		<!-- PC** - относительный профит -->

		<!-- Используемые TelPoint-ы: -->
		<!-- p, e - используются исходя из размерности записываемых величин, помещаем в p - кВт, в e - кВт*ч -->
		<!-- cost - помещаем любые цены/деньги -->
		<!-- workingTime - в данном случае используем как хранилище для результатов расчета КИУМ (возможно имеет смысл поместить в p - используемой МОЩНОСТИ же) -->
		<!--  -->

		<!-- Параметры системы -->
		<!-- Перенос цены за ЭЭ из SystemValues в _EPC_01/costs/LIMIT_PRICE_ENERGY -->
		<pseudoMeasurement target="/energyProvider[MRID='_EPC_01']/costs/addResources/addResource[purposeKey='LIMIT_PRICE_ENERGY']" telemetry="false">
			<source backupValue="0" coeff="1" path="SystemValue:cfg.gridEnergyPrice"/>
		</pseudoMeasurement>

		<!-- Перенос значения максимального перетока из SystemValues в _EXG_01/maxPOUT/TMMM -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/maxPOUT/addResources/addResource[purposeKey='TMMM']" telemetry="false">
			<source backupValue="0" coeff="1" path="SystemValue:cfg.maxPOUT"/>
		</pseudoMeasurement>

		<!-- PVS_01 Солнечная станция -->
		<!-- КИУМ -->
		<!-- Среднюю мощность за 1 час делим на номинальную мощность СЭС -->
		<!-- Кладем в _PVS_01/workingTime[CU7D], возможно резонно назвать её CU1W -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='AS1D']" telemetry="false">
			<source backupValue="0" coeff="3.33333333333" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='TM1D']"/>
		</pseudoMeasurement>
		
		<!-- Суммарная выдача за день/неделю/месяц/год, получаем из часовых значений мощности СЭС -->
		<!-- Возможно не требуется, так как энергию предполагается получать непосредственно с устройств -->
		<!-- e/TM1H численно равна p/TM1H -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='TM1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='TM1H']"/>
		</pseudoMeasurement>
		<!-- Кладем в _PVS_01/e[TM1D], делается автоматически через source в модели данных -->
		<!-- Кладем в _PVS_01/e[TM1W], делается автоматически через source в модели данных -->
		<!-- Кладем в _PVS_01/e[T1MO], делается автоматически через source в модели данных -->
		<!-- Кладем в _PVS_01/e[TM1Y], делается автоматически через source в модели данных -->

		<!-- Максимальная мощность СЭС за день/неделю/месяц/год -->
		<!-- p/MX1M, считается как функция максимума от мгновенной мощности -->
		<!-- <pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='MX1D']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='TMMM']"/>
			</function>
		</pseudoMeasurement> -->

		<!-- Потенциальная выработка СЭС. Каждый час запрашивает значение с прогноза -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='PS1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='PL24']"/>
		</pseudoMeasurement>

		<!-- Неиспользованная энергия СЭС -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='US1H']" telemetry="false">
			<function funcType="max">
				<function funcType="sum">
					<source backupValue="0" coeff="1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='PS1H']"/>
					<source backupValue="0" coeff="-1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='TM1H']"/>
				</function>
				<source backupValue="0" coeff="0" path="SystemValue:constants.zero"/>
			</function>
		</pseudoMeasurement>


		<!-- ESS_01 Накопитель Li-ion -->
		<!-- Мощность заряда - телеметрия -->
		<!-- Выбираем максимум между нулем и телеметрией мощности накопителя * -1, тем самым выбираем область заряда накопителя -->
		<!-- Средние значения за час должны считаться через source в модели данных -->
		<!-- p/CH1M -->
		<!-- p/CH1H -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_01']/p/addResources/addResource[purposeKey='CHMM']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_01']/p/addResources/addResource[purposeKey='TMMM']"/>
				<source backupValue="0" coeff="0" path="SystemValue:constants.zero"/>
			</function>
		</pseudoMeasurement>
		
		<!-- Мощность разряда -->
		<!-- Выбираем максимум между нулем и телеметрией мощности накопителя, тем самым выбираем область разряда накопителя -->
		<!-- Средние значения за час должны считаться через source в модели данных -->
		<!-- p/DC1M -->
		<!-- p/DC1H -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_01']/p/addResources/addResource[purposeKey='DCMM']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="-1" path="/energyStoragingUnit[MRID='_ESS_01']/p/addResources/addResource[purposeKey='TMMM']"/>
				<source backupValue="0" coeff="0" path="SystemValue:constants.zero"/>
			</function>
		</pseudoMeasurement>

		<!-- Накопленная энергия -->
		<!-- Возможно не требуется, так как энергию предполагается получать непосредственно с устройств -->
		<!-- e/CH1H численно равна p/CH1H -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='CH1H']" telemetry="false">
			<source coeff="1" path="/energyStoragingUnit[MRID='_ESS_01']/p/addResources/addResource[purposeKey='CH1H']"/>
		</pseudoMeasurement>
		<!-- Кладем в _ESS_01/e[CH1D], делается автоматически через source в модели данных -->
		<!-- Кладем в _ESS_01/e[CH1W], делается автоматически через source в модели данных -->
		<!-- Кладем в _ESS_01/e[CHMO], делается автоматически через source в модели данных -->
		<!-- Кладем в _ESS_01/e[CH1Y], делается автоматически через source в модели данных -->

		<!-- Переданная энергия -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='DC1H']" telemetry="false">
				<source coeff="1" path="/energyStoragingUnit[MRID='_ESS_01']/p/addResources/addResource[purposeKey='DC1H']"/>
		</pseudoMeasurement>

		<!-- Расчёт КПД СНЭ Литий -->
		<!-- Считаем КПД за день, как (Накопленная энергия + ёмкость накопителя текущая )/(Энергия разряда + ёмкость накопителя текущая - разница текущей энергоёмкости за день)*100 -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='EF1H']" telemetry="false">
			<function funcType="sum">
				<source backupValue="1" coeff="1" path="SystemValue:constants.one"/>
				<function funcType="divide">
					<function funcType="sum">
						<source backupValue="0" coeff="-1" path="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='CH1H']"/>
						<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='DC1H']"/>
						<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='DF1H']"/>
					</function>
					<function funcType="sum">
						<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='CH1H']"/>
						<source backupValue="1" coeff="1" path="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='TM1H']"/>
						<source backupValue="0" coeff="-1" path="/energyStoragingUnit[MRID='_ESS_01']/e/addResources/addResource[purposeKey='DF1H']"/>
					</function>
				</function>
			</function>
		</pseudoMeasurement>

		<!-- ESS_02 Накопитель Redox -->
		<!-- Мощность заряда - телеметрия -->
		<!-- Выбираем максимум между нулем и телеметрией мощности накопителя * -1, тем самым выбираем область заряда накопителя -->
		<!-- Средние значения за час должны считаться через source в модели данных -->
		<!-- p/CH1M -->
		<!-- p/CH1H -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_02']/p/addResources/addResource[purposeKey='CHMM']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/p/addResources/addResource[purposeKey='TMMM']"/>
				<source backupValue="0" coeff="0" path="SystemValue:constants.zero"/>
			</function>
		</pseudoMeasurement>
		
		<!-- Мощность разряда -->
		<!-- Выбираем максимум между нулем и телеметрией мощности накопителя, тем самым выбираем область разряда накопителя -->
		<!-- Средние значения за час должны считаться через source в модели данных -->
		<!-- p/DC1M -->
		<!-- p/DC1H -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_02']/p/addResources/addResource[purposeKey='DCMM']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="-1" path="/energyStoragingUnit[MRID='_ESS_02']/p/addResources/addResource[purposeKey='TMMM']"/>
				<source backupValue="0" coeff="0" path="SystemValue:constants.zero"/>
			</function>
		</pseudoMeasurement>

		<!-- Накопленная энергия -->
		<!-- Возможно не требуется, так как энергию предполагается получать непосредственно с устройств -->
		<!-- e/CH1H численно равна p/CH1H -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='CH1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/p/addResources/addResource[purposeKey='CH1H']"/>
		</pseudoMeasurement>
		<!-- Кладем в _ESS_01/e[CH1D], делается автоматически через source в модели данных -->
		<!-- Кладем в _ESS_01/e[CH1W], делается автоматически через source в модели данных -->
		<!-- Кладем в _ESS_01/e[CHMO], делается автоматически через source в модели данных -->
		<!-- Кладем в _ESS_01/e[CH1Y], делается автоматически через source в модели данных -->

		<!-- Переданная энергия -->
		<!-- Возможно не требуется, так как энергию предполагается получать непосредственно с устройств -->
		<!-- e/TM1H численно равна p/TM1H -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='DC1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/p/addResources/addResource[purposeKey='DC1H']"/>
		</pseudoMeasurement>

		<!-- Время работы редокса -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_02']/status/addResources/addResource[purposeKey='WT1M']" telemetry="false">
			<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/operMode/addResources/addResource[purposeKey='TM1M']"/>
		</pseudoMeasurement>

		<!-- Средняя мощность работы Редокса -->
		<!-- Средняя от суммы мощностей заряда и разряда при operMode > 0 -->
		<!-- TODO: здесь бред, надо переделать, голова уже не варит -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_02']/p/addResources/addResource[purposeKey='AV1H']" telemetry="false">
			<function funcType="divide">
				<function funcType="sum">
					<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='DC1H']"/>
					<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='CH1H']"/>
				</function>
				<function funcType="max">
					<source backupValue="0" coeff="1" path="SystemValue:constants.one"/>
					<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/status/addResources/addResource[purposeKey='WT1H']"/>
				</function>
			</function>
		</pseudoMeasurement>

		<!-- Расчёт КПД СНЭ редокс -->
		<!-- Считаем КПД за день, как 100 - 100*(Накопленная энергия - Энергия разряда + Разность значений энергоёмкости )/(Накопленная энергия + ёмкость накопителя текущая - Разность значений энергоёмкости ) -->
		<pseudoMeasurement target="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='EF1H']" telemetry="false">
			<function funcType="sum">
				<source backupValue="1" coeff="1" path="SystemValue:constants.one"/>
				<function funcType="divide">
					<function funcType="sum">
						<source backupValue="0" coeff="-1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='CH1H']"/>
						<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='DC1H']"/>
						<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='DF1H']"/>
					</function>
					<function funcType="sum">
						<source backupValue="0" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='CH1H']"/>
						<source backupValue="1" coeff="1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='TM1H']"/>
						<source backupValue="0" coeff="-1" path="/energyStoragingUnit[MRID='_ESS_02']/e/addResources/addResource[purposeKey='DF1H']"/>
					</function>
				</function>
			</function>
		</pseudoMeasurement>

		<!-- ULD_01 Нагрузка -->
		<!-- Максимальная мощность потребления за сутки -->
		<!-- Кладем в _ULD_01/p[MX1D] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MX1D']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='TMMM']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Максимальная мощность потребления за неделю -->
		<!-- Кладем в _ULD_01/p[MX1W] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MX1W']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MX1D']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Максимальная мощность потребления за месяц -->
		<!-- Кладем в _ULD_01/p[MXMO] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MXMO']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MX1W']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Максимальная мощность потребления за год -->
		<!-- Кладем в _ULD_01/p[MX1Y] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MX1Y']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MXMO']"/>
			</function>
		</pseudoMeasurement> -->

		<!-- Минимальная мощность потребления за сутки -->
		<!-- Кладем в _ULD_01/p[MN1D] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MN1D']" telemetry="false">
			<function funcType="min">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='TMMM']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Минимальная мощность потребления за неделю -->
		<!-- Кладем в _ULD_01/p[MN1W] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MN1W']" telemetry="false">
			<function funcType="min">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MN1D']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Минимальная мощность потребления за месяц -->
		<!-- Кладем в _ULD_01/p[MNMO] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MNMO']" telemetry="false">
			<function funcType="min">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MN1W']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Минимальная мощность потребления за год -->
		<!-- Кладем в _ULD_01/p[MN1Y] -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MN1Y']" telemetry="false">
			<function funcType="min">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='MNMO']"/>
			</function>
		</pseudoMeasurement> -->

		<!-- Суммарное потребление за день/неделю/месяц/год, получаем из часовых значений мощности нагрузки -->
		<!-- Возможно не требуется, так как энергию предполагается получать непосредственно с устройств -->
		<!-- e/TM1H численно равна p/TM1H -->
		<pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='TM1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='TM1H']"/>
		</pseudoMeasurement>
		<!-- Потребление за день - сумма всех почасовок энергии -->
		<!-- Кладем в _ULD_01/e[TM1D] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='TM1D']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='TM1H']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Потребление за неделю - сумма всех подневных энергии -->
		<!-- Кладем в _ULD_01/e[TM1W] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='TM1W']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='TM1D']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Потребление за месяц - сумма всех недельных значений энергии -->
		<!-- Кладем в _ULD_01/e[T1MO] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='T1MO']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='TM1W']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Потребление за неделю - сумма всех помесячных энергии -->
		<!-- Кладем в _ULD_01/e[TM1Y] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='TM1Y']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='T1MO']"/>
			</function>
		</pseudoMeasurement> -->

		<!-- EXG_01 Регулярная сеть -->
		<!-- Потребленная из сети мощность -->
		<!-- Выбираем максимум между нулем и телеметрией мощности сети, тем самым выбираем область получения мощности из сети -->
		<!-- Средние значения за час должны считаться через source в модели данных -->
		<!-- p/IP1M -->
		<!-- p/IP1H -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/p/addResources/addResource[purposeKey='IPMM']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/p/addResources/addResource[purposeKey='TMMM']"/>
				<source backupValue="0" coeff="0" path="SystemValue:constants.zero"/>
			</function>
		</pseudoMeasurement>
		<!-- Выданная в сеть мощность -->
		<!-- Выбираем максимум между нулем и инвертированной телеметрией мощности сети, тем самым выбираем область выдачи мощности в сеть -->
		<!-- Средние значения за час должны считаться через source в модели данных -->
		<!-- p/OP1M -->
		<!-- p/OP1H -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/p/addResources/addResource[purposeKey='OPMM']" telemetry="false">
			<function funcType="max">
				<source backupValue="0" coeff="-1" path="/externalGrid[MRID='_EXG_01']/p/addResources/addResource[purposeKey='TMMM']"/>
				<source backupValue="0" coeff="0" path="SystemValue:constants.zero"/>
			</function>
		</pseudoMeasurement>

		<!-- Полученная из сети энергия -->
		<!-- Возможно не требуется, так как энергию предполагается получать непосредственно с устройств -->
		<!-- e/TM1H численно равна p/TM1H -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/p/addResources/addResource[purposeKey='IP1H']"/>
		</pseudoMeasurement>
		<!-- Потребление за день - сумма всех почасовок энергии -->
		<!-- Кладем в _EXG_01/e[IP1D] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1D']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1H']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Потребление за неделю - сумма всех подневных энергии -->
		<!-- Кладем в _EXG_01/e[IP1W] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1W']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1D']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Потребление за месяц - сумма всех недельных значений энергии -->
		<!-- Кладем в _EXG_01/e[IPMO] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IPMO']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1W']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Потребление за неделю - сумма всех помесячных энергии -->
		<!-- Кладем в _EXG_01/e[IP1Y] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1Y']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IPMO']"/>
			</function>
		</pseudoMeasurement> -->

		<!-- Выданная в сеть энергия -->
		<!-- Возможно не требуется, так как энергию предполагается получать непосредственно с устройств -->
		<!-- e/TM1H численно равна p/TM1H -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OP1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/p/addResources/addResource[purposeKey='OP1H']"/>
		</pseudoMeasurement>
		<!-- Выдача за день - сумма всех почасовок энергии -->
		<!-- Кладем в _EXG_01/e[OP1D] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OP1D']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OP1H']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Выдача за неделю - сумма всех подневных энергии -->
		<!-- Кладем в _EXG_01/e[OP1W] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OP1W']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OP1D']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Выдача за месяц - сумма всех недельных значений энергии -->
		<!-- Кладем в _EXG_01/e[OPMO] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OPMO']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OP1W']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Выдача за неделю - сумма всех помесячных энергии -->
		<!-- Кладем в _EXG_01/e[OP1Y] -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OP1Y']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='OPMO']"/>
			</function>
		</pseudoMeasurement> -->


		<!-- Расчет базового сценария - система работает без накопителей и интеллектуального управления -->
		<!-- Мощность солнца -->
		<!-- Равна минимуму из фактической выработки солнца и нагрузки -->
		<!-- Кладем в _PVS_01/p[BS1H] -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='BS1H']" telemetry="false">
			<function funcType="min">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/p/addResources/addResource[purposeKey='TM1H']"/>
				<source backupValue="0" coeff="1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='TM1H']"/>
			</function>
		</pseudoMeasurement>
		<!-- Энергия солнца за час -->
		<!-- e/TM1H численно равна p/TM1H -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='BS1H']" telemetry="false">
			<source backupValue="0" coeff="1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='BS1H']"/>
		</pseudoMeasurement>
		<!-- Энергия солнца за день -->
		<!-- Сумма всех почасовых значений -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='BS1D']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/generatingUnitn[MRID='_PVS_01']/p/addResources/addResource[purposeKey='BS1H']"/>
			</function>
		</pseudoMeasurement> -->
		<!-- Потребление из сети -->
		<!-- Разность между нагрузкой и солцнем в базовом сценарии -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='BS1D']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/energyConsumer[MRID='_ULD_01']/e/addResources/addResource[purposeKey='BS1D']"/>
				<source backupValue="0" coeff="-1" path="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='BS1D']"/>
			</function>
		</pseudoMeasurement>

		<!-- Экономия ЭЭ за день/неделю/месяц/год -->
		<!-- Считаем как разность между живыми показателями энергии и теорией из базового сценария -->
		<!-- Кладем в _EXG_01/e[PF1D] -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PF1D']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='BS1D']"/>
				<source backupValue="0" coeff="-1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1D']"/>
			</function>
		</pseudoMeasurement>
		<!-- Неделю/месяц/год считаем как суммы более мелких интервалов -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PF1W']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PF1D']"/>
			</function>
		</pseudoMeasurement>
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PFMO']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PF1W']"/>
			</function>
		</pseudoMeasurement>
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PF1Y']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PFMO']"/>
			</function>
		</pseudoMeasurement> -->

		<!-- Покупка электроэнергии -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='IP1D']" telemetry="false">
			<function funcType="multiply">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='IP1D']"/>
				<source backupValue="0" coeff="1" path="SystemValue:cfg.gridEnergyPrice"/>
			</function>
		</pseudoMeasurement>

		<!-- Экономия в рублях за день/неделю/месяц/год -->
		<!-- Перемножение профита на цену ЭЭ -->
		<!-- TODO: указать верную точку для цен -->
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='PF1D']" telemetry="false">
			<function funcType="multiply">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/e/addResources/addResource[purposeKey='PF1D']"/>
				<source backupValue="0" coeff="1" path="SystemValue:cfg.gridEnergyPrice"/>
			</function>
		</pseudoMeasurement>
		<!-- Неделю/месяц/год считаем как суммы более мелких интервалов -->
		<!-- TODO: переделать на агрегацию через модель данных -->
		<!-- <pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='PF1W']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='PF1D']"/>
			</function>
		</pseudoMeasurement>
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='PFMO']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='PF1W']"/>
			</function>
		</pseudoMeasurement>
		<pseudoMeasurement target="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='PF1Y']" telemetry="false">
			<function funcType="sum">
				<source backupValue="0" coeff="1" path="/externalGrid[MRID='_EXG_01']/cost/addResources/addResource[purposeKey='PFMO']"/>
			</function>
		</pseudoMeasurement> -->



		<!-- КИУМ при базовом сценарии -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='BS1D']" telemetry="false">
			<source backupValue="0" coeff="3.33333333333" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='BS1D']"/>
		</pseudoMeasurement>
		<!-- Разница КИУМ между сценариями -->
		<!-- 1 день -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='AB1D']" telemetry="false">
			<function funcType="sum">
				<source coeff="1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='AS1D']"/>
				<source coeff="-1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='BS1D']"/>
			</function>
		</pseudoMeasurement>
		<!-- 1 неделя -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='AB1W']" telemetry="false">
			<function funcType="sum">
				<source coeff="1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='AS1W']"/>
				<source coeff="-1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='BS1W']"/>
			</function>
		</pseudoMeasurement>
		<!-- 1 месяц -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='ABMO']" telemetry="false">
			<function funcType="sum">
				<source coeff="1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='ASMO']"/>
				<source coeff="-1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='BSMO']"/>
			</function>
		</pseudoMeasurement>
		<!-- 1 год -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='AB1Y']" telemetry="false">
			<function funcType="sum">
				<source coeff="1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='AS1Y']"/>
				<source coeff="-1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='BS1Y']"/>
			</function>
		</pseudoMeasurement>

		<!-- Отпуск СЭС увеличен на, кВтч -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='PF1H']" telemetry="false">
			<function funcType="sum">
				<source coeff="1" path="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='TM1H']"/>
				<source coeff="-1" path="/generatingUnit[MRID='_PVS_01']/e/addResources/addResource[purposeKey='BS1H']"/>
			</function>
		</pseudoMeasurement>

		<!-- Выбросы СО2 снижены на -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='CO1H']" telemetry="false">
			<function funcType="multiply">
				<source coeff="1" path="/generatingUnit[MRID='_PVS_01']/p/addResources/addResource[purposeKey='TM1H']"/>
				<source backupValue="0" coeff="0.5" path="SystemValue:constants.one"/>
			</function>
		</pseudoMeasurement>

		<!-- Количество деревьев -->
		<pseudoMeasurement target="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='TS1D']" telemetry="false">
			<function funcType="divide">
				<source coeff="1" path="/generatingUnit[MRID='_PVS_01']/workingTime/addResources/addResource[purposeKey='CO1D']"/>
				<source backupValue="0" coeff="1000" path="SystemValue:constants.one"/>
			</function>
		</pseudoMeasurement>

	</repositoryConfig>
	<remotingConfig address="127.0.0.1"/>
	<pluginTypes>
		<!-- Состав модулей -->
		<!-- ALOG -->
		<!-- CBER -->
		<!-- FLST -->
		<!-- IDFL -->
		<!-- IHTC -->
		<!-- IHTS -->
		<!-- IMDB -->
		<!-- OMOD -->
		<!-- SCLK -->
		<!-- SSSW -->
		<pluginType class="ru.rtsoft.amigo.alog.ALOG" desc="Журнал событий" jarLocation="default" nameOfType="ALOG" version="1.0-SNAPSHOT">
			<operations>
				<operation exPeriod="PT0S">RECD</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" operName="RECD"/>
					<command action="stop" operName="RECD"/>
					<command action="pause" operName="RECD"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="fail" operName="INIT"/>
					<event action="start" operName="RECD"/>
					<event action="pause" operName="RECD"/>
					<event action="stop" operName="RECD"/>
					<event action="success" operName="RECD"/>
					<event action="fail" operName="RECD"/>
				</events>
			</pluginIface>
		</pluginType>
		<pluginType class="ru.rtsoft.amigo.cber.CBER" desc="Оперативное управление" jarLocation="default" nameOfType="CBER" version="1.0-SNAPSHOT">
			<operations>
				<operation exPeriod="PT0S" desc="Задача управления накопителями и генераторами по текущим данным">GVRN</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" operName="GVRN"/>
					<command action="stop" operName="GVRN"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event operName="INIT" action="start"/>
					<event operName="INIT" action="success"/>
					<event operName="INIT" action="fail"/>
					<event operName="GVRN" action="start"/>
                    <event operName="GVRN" action="stop"/>
                    <event operName="GVRN" action="fail"/>
				</events>
			</pluginIface>
		</pluginType>
		<pluginType class="ru.rtsoft.amigo.flst.FLST" desc="Цикличный прогноз" jarLocation="default" nameOfType="FLST" version="1.0-SNAPSHOT">
			<operations>
				<operation desc="Прогноз на 15 минут, дискретность 1 минута" exPeriod="PT1M">LF15</operation>
				<operation desc="Прогноз на сутки, дискретность 1 час" exPeriod="PT3M">LF24</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" operName="LF15"/>
					<command action="stop" operName="LF15"/>
					<command action="start" operName="LF24"/>
					<command action="stop" operName="LF24"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="fail" operName="INIT"/>
					<event action="start" operName="LF15"/>
					<event action="stop" operName="LF15"/>
					<event action="fail" operName="LF15"/>
					<event action="success" operName="LF15"/>
					<event action="start" operName="LF24"/>
					<event action="stop" operName="LF24"/>
					<event action="fail" operName="LF24"/>
					<event action="success" operName="LF24"/>
				</events>
				<addResourceGroups>
					<addResourceGroup desc="TMMM" name="TMMM">TMMM</addResourceGroup>
					<addResourceGroup desc="FL15" name="FL15">FL15</addResourceGroup>
					<addResourceGroup desc="FL24" name="FL24">FL24</addResourceGroup>
				</addResourceGroups>
			</pluginIface>
		</pluginType>
		<pluginType class="ru.rtsoft.amigo.idfl.IDFL" desc="Загрузки данных из файлов" jarLocation="default" nameOfType="IDFL" version="1.0-SNAPSHOT">
			<operations>
				<operation>LOAD</operation>
				<operation>TRFF</operation>
				<operation exPeriod="PT0S">USER</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" operName="LOAD"/>
					<command action="stop" operName="LOAD"/>
					<command action="start" operName="TRFF"/>
					<command action="stop" operName="TRFF"/>
					<command action="start" operName="USER"/>
					<command action="stop" operName="USER"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="fail" operName="INIT"/>
					<event action="start" operName="LOAD"/>
					<event action="stop" operName="LOAD"/>
					<event action="success" operName="LOAD"/>
					<event action="fail" operName="LOAD"/>
					<event action="start" operName="TRFF"/>
					<event action="stop" operName="TRFF"/>
					<event action="success" operName="TRFF"/>
					<event action="fail" operName="TRFF"/>
					<event action="start" operName="USER"/>
					<event action="stop" operName="USER"/>
					<event action="success" operName="USER"/>
					<event action="fail" operName="USER"/>
				</events>
			</pluginIface>
		</pluginType>
		<pluginType class="ru.rtsoft.amigo.ihtc.IHTC" desc="HTTP-клиент" jarLocation="default" nameOfType="IHTC" version="1.0-SNAPSHOT">
			<operations>
				<operation exPeriod="PT5M">CLFC</operation>
				<operation exPeriod="P1D" persistent="true" exOffset="PT5M">CLFE</operation>
				<operation exPeriod="P7D" persistent="true">CLTM</operation>
				<operation>CLOM</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" desc="Запрос прогноза" operName="CLFC"/>
					<command action="stop" desc="Остановить запрос прогноза" operName="CLFC"/>
					<command action="start" desc="Запрос расчета ошибки прогноза" operName="CLFE"/>
					<command action="stop" desc="Остановить запрос расчета ошибки прогноза" operName="CLFE"/>
					<command action="start" desc="Запрос обучения модели" operName="CLTM"/>
					<command action="stop" desc="Остановить запрос обучения модели" operName="CLTM"/>
					<command action="start" desc="Запрос оптимизации" operName="CLOM"/>
					<command action="stop" desc="Остановить запрос оптимизации" operName="CLOM"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="fail" operName="INIT"/>
					<event action="start" operName="CLFC"/>
					<event action="success" operName="CLFC"/>
					<event action="fail" operName="CLFC"/>
					<event action="start" operName="CLFE"/>
					<event action="success" operName="CLFE"/>
					<event action="fail" operName="CLFE"/>
					<event action="start" operName="CLTM"/>
					<event action="success" operName="CLTM"/>
					<event action="fail" operName="CLTM"/>
					<event action="start" operName="CLOM"/>
					<event action="success" operName="CLOM"/>
					<event action="fail" operName="CLOM"/>
				</events>
			</pluginIface>
		</pluginType>   
		<pluginType class="ru.rtsoft.amigo.ihts.IHTS" desc="Веб-сервер" jarLocation="default" nameOfType="IHTS" version="1.0-SNAPSHOT">
			<operations>
				<operation exPeriod="PT0S">WEBS</operation>
				<operation exPeriod="PT0S">WSOC</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" desc="Запуск HTTP-сервера" operName="WEBS"/>
					<command action="stop" desc="Останов HTTP-сервера" operName="WEBS"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="success" operName="FT00"/>
					<event action="success" operName="FT01"/>
					<event action="success" operName="FE01"/>
					<event action="success" operName="FT11"/>
					<event action="success" operName="FE11"/>
					<event action="start" operName="WEBS"/>
					<event action="stop" operName="WEBS"/>
					<event action="fail" operName="WEBS"/>
					<event action="start" operName="WSOC"/>
					<event action="success" operName="WSOC"/>
					<event action="fail" operName="WSOC"/>
				</events>
			</pluginIface>
		</pluginType>
		<pluginType class="ru.rtsoft.amigo.imdb.IMDB" desc="Сбор данных Modbus TCP" jarLocation="default" nameOfType="IMDB" version="1.0-SNAPSHOT">
			<operations>
				<operation exPeriod="PT0S">WORK</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" operName="WORK"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="fail" operName="INIT"/>
					<event action="start" operName="WORK"/>
					<event action="success" operName="WORK"/>
					<event action="fail" operName="WORK"/>
				</events>
				<addResourceGroups>
					<addResourceGroup desc="TMMM - телеметрия" name="TMMM">TMMM</addResourceGroup>
				</addResourceGroups>
			</pluginIface>
		</pluginType>
		<pluginType class="ru.rtsoft.amigo.sclk.SCLK" desc="Модуль таймеров" jarLocation="default" nameOfType="SCLK" version="1.0-SNAPSHOT">
			<operations>
				<operation>TURN</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" operName="TURN"/>
					<command action="stop" operName="TURN"/>
					<command action="pause" operName="TURN"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="fail" operName="INIT"/>
					<event action="start" operName="TURN"/>
					<event action="success" operName="TURN"/>
					<event action="fail" operName="TURN"/>
				</events>
			</pluginIface>
		</pluginType>
		<pluginType class="ru.rtsoft.amigo.sssw.SSSW" desc="Смена режимов работы" jarLocation="default" nameOfType="SSSW" version="1.0-SNAPSHOT">
			<operations>
				<operation>STAT</operation>
				<operation>IDLE</operation>
				<operation>AUTO</operation>
			</operations>
			<pluginIface>
				<commands>
					<command action="start" operName="INIT"/>
					<command action="start" operName="STAT"/>
					<command action="stop" operName="STAT"/>
					<command action="pause" operName="STAT"/>
					<command action="start" operName="RSET"/>
				</commands>
				<events>
					<event action="start" operName="INIT"/>
					<event action="success" operName="INIT"/>
					<event action="fail" operName="INIT"/>
					<event action="start" operName="STAT"/>
					<event action="success" operName="STAT"/>
					<event action="stop" operName="STAT"/>
					<event action="fail" operName="STAT"/>
					<event action="success" operName="IDLE"/>
					<event action="stop" operName="IDLE"/>
					<event action="success" operName="AUTO"/>
					<event action="stop" operName="AUTO"/>
				</events>
			</pluginIface>
		</pluginType>
	</pluginTypes>
	<pluginConfigs>
		<pluginConfig desc="Запись журнала ПО (module-journal)" pluginInstance="0" pluginType="ALOG" url="default">
			<pluginSettings path="./subconfigs/ALOG-00.xml"/>
		</pluginConfig>
		<pluginConfig desc="Запись журнала объекта управления (main-journal)" pluginInstance="1" pluginType="ALOG" url="default">
			<pluginSettings path="./subconfigs/ALOG-01.xml"/>
		</pluginConfig>

		<pluginConfig desc="Модуль управления оборудованием" pluginInstance="0" pluginType="CBER" url="default">
			<transientParams>
				<!-- <repoLink repoPath="/externalGrid[MRID='_EXG_01']/maxPOUT/addResources/addResource[purposeKey='TMMM']" configPath="/maxPowerExport"/> -->
				<!-- <repoLink repoPath="SystemValue:cfg.setValueThreshold" configPath="/setValueThreshold"/> -->
				<repoLink repoPath="SystemValue:cfg.maxPOUT" configPath="/maxPowerExport"/>
			</transientParams>
			<pluginSettings path="./subconfigs/CBER-00.xml"/>
		</pluginConfig>
		<pluginConfig desc="Загрузка заглушки прогнозов" pluginInstance="0" pluginType="FLST" url="default">
			<pluginSettings path="./subconfigs/FLST-00.xml"/>
		</pluginConfig>
		<pluginConfig desc="Загрузка заглушки цены СЭС" pluginInstance="1" pluginType="FLST" url="default">
			<pluginSettings path="./subconfigs/FLST-01.xml"/>
		</pluginConfig>
		<pluginConfig desc="Загрузка списка пользователей" pluginInstance="0" pluginType="IDFL" url="default">
			<pluginSettings path="./subconfigs/IDFL-00.xml"/>
		</pluginConfig>
		<pluginConfig desc="Загрузка тестовой истории" pluginInstance="1" pluginType="IDFL" url="default">
			<pluginSettings path="./subconfigs/IDFL-01.xml"/>
		</pluginConfig>

		<pluginConfig desc="HTTP-клиент, запрос оптимизации" pluginInstance="0" pluginType="IHTC" url="default">
			<pluginSettings path="./subconfigs/IHTC-00.xml"/>
		</pluginConfig>
		<pluginConfig desc="HTTP-клиент, обучение прогнозера нагрузки и запрос прогноза" pluginInstance="1" pluginType="IHTC" url="default">
			<pluginSettings path="./subconfigs/IHTC-01.xml"/>
		</pluginConfig>
		<pluginConfig desc="HTTP-клиент, обучение прогнозера СЭС и запрос прогноза" pluginInstance="11" pluginType="IHTC" url="default">
			<pluginSettings path="./subconfigs/IHTC-11.xml"/>
		</pluginConfig>
		<pluginConfig desc="HTTP-клиент, обучение прогнозера СЭС и запрос прогноза для расчёта потенциальной выработки" pluginInstance="12" pluginType="IHTC" url="default">
			<pluginSettings path="./subconfigs/IHTC-12.xml"/>
		</pluginConfig>
		<!-- <pluginConfig desc="HTTP-клиент, запрос ошибок прогнозирования" pluginInstance="21" pluginType="IHTC" url="default">
			<pluginSettings path="./subconfigs/IHTC-21.xml"/>
		</pluginConfig> -->

		<pluginConfig desc="Сервер REST, WS, AMIGO Web Monitor" pluginInstance="0" pluginType="IHTS" url="default">
			<pluginSettings path="./subconfigs/IHTS-00.xml"/>
		</pluginConfig>

		<pluginConfig desc="Связь с нагрузкой" pluginInstance="1" pluginType="IMDB" url="default">
			<pluginSettings path="./subconfigs/IMDB-01.xml"/>
		</pluginConfig>
		<pluginConfig desc="Связь с СЭС" pluginInstance="11" pluginType="IMDB" url="default">
			<pluginSettings path="./subconfigs/IMDB-11.xml"/>
		</pluginConfig>
		<pluginConfig desc="Связь с накопителем 1 - Li-ion" pluginInstance="21" pluginType="IMDB" url="default">
			<pluginSettings path="./subconfigs/IMDB-21.xml"/>
		</pluginConfig>
		<pluginConfig desc="Связь с накопителем 2 - Redox" pluginInstance="22" pluginType="IMDB" url="default">
			<pluginSettings path="./subconfigs/IMDB-22.xml"/>
		</pluginConfig>

		<pluginConfig desc="Связь с сетью" pluginInstance="31" pluginType="IMDB" url="default">
			<pluginSettings path="./subconfigs/IMDB-31.xml"/>
		</pluginConfig>

		<pluginConfig desc="Задержка старта оптимизатора" pluginInstance="0" pluginType="SCLK" url="default">
			<pluginSettings path="./subconfigs/SCLK-00.xml"/>
		</pluginConfig>
		<pluginConfig desc="Смена режимов" pluginInstance="0" pluginType="SSSW" url="default">
			<pluginSettings path="./subconfigs/SSSW-00.xml"/>
		</pluginConfig>
	</pluginConfigs>
	<schedulerConfigs>
		<schedulerConfig>
			<!-- Старт при инициализации -->
			<!-- Запуск логера для журналов событий при инициализации -->
			<rule desc="Запуск ALOG-00 (module-journal)">
				<actions>
					<action action="start" operName="RECD" pluginInstance="0" pluginType="ALOG"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="0" pluginType="ALOG"/>
					</andOper>
				</conditions>
			</rule>
			<!-- Временно отключено т.к. нет адаптера для работы с оборудованием проекта <rule desc="Запуск ALOG-01 (main-journal)">
				<actions>
					<action action="start" operName="RECD" pluginInstance="1" pluginType="ALOG"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="1" pluginType="ALOG"/>
					</andOper>
				</conditions>
			</rule> -->

			<rule desc="Запуск IDFL-00">
				<actions>
					<action action="start" operName="USER" pluginInstance="0" pluginType="IDFL"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="0" pluginType="IDFL"/>
					</orOper>
				</conditions>
			</rule>
			<!-- Временно отключено, т.к. данные уже загружены в систему, повторная загрузка необходима после очистки БД <rule desc="Запуск IDFL-01">
				<actions>
					<action action="start" operName="LOAD" pluginInstance="1" pluginType="IDFL"/>
					<action action="start" operName="TRFF" pluginInstance="1" pluginType="IDFL"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="1" pluginType="IDFL"/>
					</orOper>
				</conditions>
			</rule> -->

			<rule desc="Запуск IHTC-01 CLFC">
				<actions>
					<action action="start" operName="CLFC" pluginInstance="1" pluginType="IHTC"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="1" pluginType="IHTC"/>
					</orOper>
				</conditions>
			</rule>

			<rule desc="Запуск IHTC-11 CLFC">
				<actions>
					<action action="start" operName="CLFC" pluginInstance="11" pluginType="IHTC"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="11" pluginType="IHTC"/>
					</orOper>
				</conditions>
			</rule>

			<rule desc="Запуск IHTC-12 CLFC">
				<actions>
					<action action="start" operName="CLFC" pluginInstance="12" pluginType="IHTC"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="12" pluginType="IHTC"/>
					</orOper>
				</conditions>
			</rule>

			<rule desc="Запуск IHTS-00">
				<actions>
					<action action="start" operName="WEBS" pluginInstance="0" pluginType="IHTS"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="0" pluginType="IHTS"/>
						<trigger action="fail" negation="false" operName="WEBS" pluginInstance="0" pluginType="IHTS"/>
					</orOper>
				</conditions>
			</rule>

			<!-- IMDB-01 - Нагрузка ULD-01 -->
			<rule desc="Запуск IMDB-01">
				<actions>
					<action action="start" operName="WORK" pluginInstance="1" pluginType="IMDB"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="1" pluginType="IMDB"/>
						<trigger action="fail" negation="false" operName="WORK" pluginInstance="1" pluginType="IMDB"/>
					</orOper>
				</conditions>
			</rule>
			<!-- IMDB-11 - СЭС PVS-01 -->
			<rule desc="Запуск IMDB-11">
				<actions>
					<action action="start" operName="WORK" pluginInstance="11" pluginType="IMDB"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="11" pluginType="IMDB"/>
						<trigger action="fail" negation="false" operName="WORK" pluginInstance="11" pluginType="IMDB"/>
					</orOper>
				</conditions>
			</rule>
			<!-- IMDB-21 - СНЭ ESS-01 -->
			<rule desc="Запуск IMDB-21">
				<actions>
					<action action="start" operName="WORK" pluginInstance="21" pluginType="IMDB"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="21" pluginType="IMDB"/>
						<trigger action="fail" negation="false" operName="WORK" pluginInstance="21" pluginType="IMDB"/>
					</orOper>
				</conditions>
			</rule>
			<!-- IMDB-22 - СНЭ ESS-02 -->
			<rule desc="Запуск IMDB-22">
				<actions>
					<action action="start" operName="WORK" pluginInstance="22" pluginType="IMDB"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="22" pluginType="IMDB"/>
						<trigger action="fail" negation="false" operName="WORK" pluginInstance="22" pluginType="IMDB"/>
					</orOper>
				</conditions>
			</rule>
			<!-- IMDB-31 - СЭС EXG-01 -->
			<rule desc="Запуск IMDB-31">
				<actions>
					<action action="start" operName="WORK" pluginInstance="31" pluginType="IMDB"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="31" pluginType="IMDB"/>
						<trigger action="fail" negation="false" operName="WORK" pluginInstance="31" pluginType="IMDB"/>
					</orOper>
				</conditions>
			</rule>

			<!-- Заглушка прогнозов из CSV -->
			<!-- Не используется после введения облачных прогнозов <rule desc="Запуск FLST-00">
				<actions>
					<action action="start" operName="LF15" pluginInstance="0" pluginType="FLST"/>
					<action action="start" operName="LF24" pluginInstance="0" pluginType="FLST"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="0" pluginType="FLST"/>
					</orOper>
				</conditions>
			</rule> -->
			<!-- Заглушка цен СЭС -->
			<rule desc="Запуск FLST-01">
				<actions>
					<action action="start" operName="LF24" pluginInstance="1" pluginType="FLST"/>
				</actions>
				<conditions>
					<orOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="1" pluginType="FLST"/>
					</orOper>
				</conditions>
			</rule>

			<!-- Управление режимами работы -->
			<!-- SSSW-00 - смена режимов работы системы -->
			<rule desc="Запуск SSSW-00">
				<actions>
					<action action="start" operName="STAT" pluginInstance="0" pluginType="SSSW"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="INIT" pluginInstance="0" pluginType="SSSW"/>
						<trigger action="success" negation="false" operName="INIT" pluginInstance="0" pluginType="CBER"/>
					</andOper>
				</conditions>
			</rule>
			<!-- Отключение управления при нажатии кнопки на интерфейсе "отключить автоматическое управление" -->
			<rule desc="Останов CBER-00 при SSSW-IDLE">
				<actions>
					<action action="stop" operName="GVRN" pluginInstance="0" pluginType="CBER"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="IDLE" pluginInstance="0" pluginType="SSSW"/>
					</andOper>
				</conditions>
			</rule>
			<!-- Включение управления при нажатии кнопки на интерфейсе "включить автоматическое управление" -->
			<rule desc="Запуск CBER-00 при SSSW-AUTO">
				<actions>
					<action action="start" operName="GVRN" pluginInstance="0" pluginType="CBER"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="AUTO" pluginInstance="0" pluginType="SSSW"/>
					</andOper>
				</conditions>
			</rule>

			<!-- Запускаем счет задержки старта оптимизации после загрузки прогнозов -->
			<rule desc="Запуск SCLK-00 TURN">
				<actions>
					<action action="start" operName="TURN" pluginInstance="0" pluginType="SCLK"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="CLFC" pluginInstance="1" pluginType="IHTC"/>
						<trigger action="success" negation="false" operName="CLFC" pluginInstance="11" pluginType="IHTC"/>
					</andOper>
				</conditions>
			</rule>

			<!-- Автоматический запуск облачной оптимизации по прошествию 10 секунд после обновления прогнов -->
			<rule desc="Запуск IHTC-00 CLOM">
				<actions>
					<action action="start" operName="CLOM" pluginInstance="0" pluginType="IHTC"/>
					<!-- <action action="start" operName="RSET" pluginInstance="0" pluginType="SCLK"/> -->
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="TURN" pluginInstance="0" pluginType="SCLK"/>
					</andOper>
				</conditions>
			</rule>

			<!-- Автоматический перезапуск запросов прогнозов при ошибке -->
			<rule desc="Запуск IHTC-01-CLCF при IHTC-01-CLCF-fail">
				<actions>
					<action action="start" operName="CLFC" pluginInstance="1" pluginType="IHTC"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="fail" negation="false" operName="CLFC" pluginInstance="1" pluginType="IHTC"/>
					</andOper>
				</conditions>
			</rule>
			<rule desc="Запуск IHTC-11-CLCF при IHTC-11-CLCF-fail">
				<actions>
					<action action="start" operName="CLFC" pluginInstance="11" pluginType="IHTC"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="fail" negation="false" operName="CLFC" pluginInstance="11" pluginType="IHTC"/>
					</andOper>
				</conditions>
			</rule>

			<!-- Ручной запуск облачной оптимизации через REST -->
			<rule desc="Запуск IHTC-00-CLOM при IHTS-FT00">
				<actions>
					<action action="start" operName="CLOM" pluginInstance="0" pluginType="IHTC"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="FT00" pluginInstance="0" pluginType="IHTS"/>
					</andOper>
				</conditions>
			</rule>
			<!-- Ручной запуск обучения прогнозных моделей через REST -->
			<rule desc="Запуск IHTC-01-CLTM при IHTS-FT01">
				<actions>
					<action action="start" operName="CLTM" pluginInstance="1" pluginType="IHTC"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="FT01" pluginInstance="0" pluginType="IHTS"/>
					</andOper>
				</conditions>
			</rule>
			<rule desc="Запуск IHTC-11-CLTM при IHTS-FT11">
				<actions>
					<action action="start" operName="CLTM" pluginInstance="11" pluginType="IHTC"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="FT11" pluginInstance="0" pluginType="IHTS"/>
					</andOper>
				</conditions>
			</rule>
			<!-- Ручной запуск расчета ошибки прогнозирования через REST -->
			<rule desc="Запуск IHTC-01-CLFE при IHTS-FE01">
				<actions>
					<action action="start" operName="CLFE" pluginInstance="1" pluginType="IHTC"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="FE01" pluginInstance="0" pluginType="IHTS"/>
					</andOper>
				</conditions>
			</rule>
			<rule desc="Запуск IHTC-11-CLFE при IHTS-FT11">
				<actions>
					<action action="start" operName="CLFE" pluginInstance="11" pluginType="IHTC"/>
				</actions>
				<conditions>
					<andOper negation="false">
						<trigger action="success" negation="false" operName="FE11" pluginInstance="0" pluginType="IHTS"/>
					</andOper>
				</conditions>
			</rule>
		</schedulerConfig>
	</schedulerConfigs>
</amigoConfiguration>